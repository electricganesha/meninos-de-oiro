<!DOCTYPE html>
<html>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700' rel='stylesheet' type='text/css'>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.10/angular.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.10/angular-ui-router.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.19/angular-cookies.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jscolor/2.0.4/jscolor.min.js"></script>
  <script src="/javascripts/angular.js"></script>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body ng-app="meninos-de-oiro">
    <ui-view></ui-view>
    <script type="text/ng-template" id="/admin.html">
   </script>
    <script type="text/ng-template" id="/home.html">
      <div class="container">

        <h2 class="form-signin-heading" style="text-align:center; margin-bottom:50px; border-bottom: 1px solid #000; padding-bottom:15px;"> Administração - Meninos de Oiro </h2>

    <div class="page-header text-center" style=" width:100%;">
        <div style=" display: inline-block; width:100%; height:100%;">
          <p style="float:left;"> Bem-vindo(a) <strong><%= user.local.username %></strong>. </p>
          <div style="position:absolute; top:9vh; left:40vw;">
            <li style="display:inline-block;">
          <ul style="display:inline;"><img src="images/icon/file.png" style="width:64px; height:64px; cursor:pointer;" ng-click="show = 'news'"></ul>
          <ul style="display:inline;"><img src="images/icon/list.png" style="width:64px; height:64px; cursor:pointer;" ng-click="show = 'categories'"></ul>
          <ul style="display:inline;"><img src="images/icon/coins.png" style="width:64px; height:64px; cursor:pointer;" ng-click="show = 'finance'"></ul>
          </li>
          </div>
          <a href="/logout" class="btn btn-default btn-sm" style="float:right;">Terminar Sessão</a></div>
          </div>
    <div class="row">
        <!-- LOCAL INFORMATION -->
        </div>

    </div>
<div class="container-fluid" style="margin:15px;" ng-init="show = 'news';" ng-show="show == 'news'">
  <div class="col-sm-6" style="width:95vw; margin:10px;">
  <div class="row" ng-controller="TableCtrl">
    <div class="procedure-details" ng-show="showDetails" style="position:absolute; left:22.5vw; background-color:white; width:50vw; padding:40px; border-radius:25px; z-index:2;">
      <!-- LOGIN FORM -->
      <button type="button" ng-click="showDetails = ! showDetails" class="btn btn-xs btn-danger" style="float:right; border-radius:25px;">
      <i class="glyphicon glyphicon-remove-sign"></i>
      </button>
      <form ng-submit="addNews()" name="newNewsForm">
          <h2 style="margin-bottom:20px;"><u>Nova Notícia</u></h2>
          <div class="form-group">
              <label>Categoria:</label>
                <select class="form-control" name="categoriaSelect" ng-model="categoria" ng-options="category.name for category in getStructureCategories()">
                </select>
          </div>
          <div class="form-group">
              <label>Título:</label>
              <input type="text" class="form-control" name="titulo" ng-model="titulo" placeholder="Por favor introduza o título da notícia.">
          </div>
          <div class="form-group">
              <label>URL / Link:</label>
              <input type="text" class="form-control" name="link" ng-model="link" placeholder="Por favor introduza o URL/Link da notícia.">
          </div>
          <div class="form-group">
              <label>Rubrica:</label>
              <input type="text" class="form-control" name="rubrica" ng-model="rubrica" placeholder="Por favor introduza a rubrica notícia.">
          </div>
          <div class="form-group" style="display:inline-block;">
            <label>Imagem:</label>
            <br>
            <label for="files" class="btn btn-sm btn-success" style="margin-left:5px;">Escolha uma imagem do seu computador</label>&nbsp; ou &nbsp; <input type="text" class="form-control" name="imagem" ng-model="imagem" placeholder="Introduza o link da imagem." style="display:inline-block; width:15vw;">
            <input id="files" onchange="angular.element(this).scope().fileNameChanged(this)" type="file" class="form-control" name="uploadImageFile" placeholder="Por favor escolha uma imagem do seu computador." style="visibility:hidden;">
          </div>
          <div class="form-group">
              <label>Texto:</label>
              <input type="text" class="form-control" name="texto" ng-model="texto" placeholder="Por favor introduza o texto de corpo da notícia.">
          </div>
          <div>
          <button type="submit" class="btn btn-sm btn-success" style="float:right; margin-top:10px;" ng-click="showDetails = ! showDetails">
          <i class="glyphicon glyphicon-ok"></i> &nbsp;  &nbsp; &nbsp;Inserir Notícia
          </button>
          </div>
      </form>
   </div>
<table st-table="rowCollection" class="table table-hover" style="height:70vh; width:100%;" st-safe-src="collection" st-watch-changes="true">
  <thead>
  <tr>
    <th>Categoria</th>
    <th>Titulo</th>
    <th>Link</th>
    <th>Titulo Extendido</th>
    <th>Imagem</th>
    <th>Texto</th>
    <th>Data</th>
    <th>Likes</th>
    <th>
      <button type="button" ng-click="showDetails = ! showDetails" class="btn btn-sm btn-success" style="float:left;">
      <i class="glyphicon glyphicon-plus-sign"></i> Inserir
      </button>
    </th>
  </tr>
  </thead>
  <tbody>
  <tr ng-repeat="newsPost in news | orderBy:'-date'">
    <td style="width:125px;" >
      <select class="form-control" ng-init="optionCategory = newsPost.category" name="categoriaSelect" ng-model="optionCategory" ng-options="category for category in getStructureCategories()" ng-change="changeCategory(optionCategory,newsPost)">
      </select>
    </td>
    <td><div contentEditable="true" ng-model="row.title">{{newsPost.title}}</td>
    <td><div contentEditable="true" ng-model="row.link">{{newsPost.link}}</td>
    <td><div contentEditable="true" ng-model="row.body">{{newsPost.body}}</td>
    <td style="border: 1px solid blue;">
      <div style=" position: relative;  width: 180px; height: 100px; overflow: hidden; border:1px solid black;" >
      <label for="file-input">
        <img src="{{newsPost.imageLink}}" style="cursor: pointer; position: absolute; left: 50%; top: 50%; height: 100%; width: auto; -webkit-transform: translate(-50%,-50%); -ms-transform: translate(-50%,-50%); transform: translate(-50%,-50%);">
      </label>
      <input id="file-input" type="file" style="display:none;" onchange="angular.element(this).scope().changeImage(this)" name="imageChange">
      </div>
      <div contentEditable="true" style=" border:1px solid black;position:relative; width:180px; color:black; text-align:left; margin-top:10px;" ng-model="row.imageLink"> {{newsPost.imageLink}} </div>
      </div>
    </td>
    <td><div contentEditable="true" ng-model="row.text">{{newsPost.text}}</td>
    <td><div ng-model="row.date" style=" width:80px; font-size:9px;">{{newsPost.date | date :'dd-M-yyyy H:mm'}}</td>
    <td><div ng-model="row.upvotes" style="font-size:9px;">{{newsPost.upvotes}}</td>
    <td style="width:50px;">
<button style="margin-left:25%;"type="button" ng-click="removeItem(row,newsPost)" class="btn btn-sm btn-danger">
<i class="glyphicon glyphicon-trash">
</i>
</button>
</td>
  </tr>
  </tbody>
  <tfoot>
    <tr>
				<td colspan="5" class="text-center">
					<div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div>
				</td>
			</tr>
  </tfoot>
</table>
</div>
</div>
</div>
<div class="container-fluid" style="margin:15px;" ng-show="show == 'categories'" ng-controller="TableCtrl">
    <table st-table="rowCollection" class="table table-striped">
	<thead>
	<tr>
		<th>Categoria</th>
		<th>Cor</th>
		<th>Icone</th>
    <th>
      <button type="button" ng-click="showDetails = ! showDetails" class="btn btn-sm btn-success" style="float:left;">
      <i class="glyphicon glyphicon-plus-sign"></i> Inserir
      </button>
    </th>
	</tr>
	</thead>
	<tbody>
	<tr ng-repeat="category in categories">
		<td>{{category.name}}</td>
		<td style="background-color:{{category.color}}"></td>
		<td><img src="{{category.iconPath}}" style="width:64px; height:64px;"></td>
    <td style="width=50px;">
      <button style="margin-left:2.5%;"type="button" ng-click="removeItem(row,newsPost)" class="btn btn-sm btn-danger">
      <i class="glyphicon glyphicon-trash">
      </i>
      </button>
    </td>
	</tr>
	</tbody>
</table>
  <div style="background-color:hotpink; width:100%; height:100%;"></div>
</div>
<div class="container-fluid" style="margin:15px;" ng-show="show == 'finance'">
  <p> FINANÇAAAAAS </p>
</div>

</script>
  </body>
</html>
